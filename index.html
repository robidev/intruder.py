<!DOCTYPE html>
<html lang='en'>
<head>
<title>Intruder</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="layout.css" rel="stylesheet" type="text/css"></link>
<link href="vis.min.css" rel="stylesheet" type="text/css" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script type="text/javascript" src="socket.io.min.js"></script>
<script type="text/javascript" src="tdi.tabs.js"></script>
<script type="text/javascript" src="vis.min.js"></script>
<script type="text/javascript">
  var nodes, edges, network;
	
	$(document).ready(function() {
		//add tabs
		$("#hostlogtab").dynatabs({
			tabBodyID : "hostlogbody",
			showCloseBtn : true,
		});

    /*$('#stopStreamButtonID').click(function(event) {        
	    socket.emit('stopStreamButtonID', {data: ''});
    });

	  namespace = '';

    var socket = io.connect('http://' + document.domain + ':' + location.port + namespace);
    socket.on('connect', function() {
        socket.emit('my event', {data: 'Connected to server'});
    });

    socket.on('serverUpdate', function(msg) {
	    //console.log(msg);
	    setStatus(msg);				
    });
    socket.on('lastTrialDiv', function(msg) {
	    console.log('lastTrialDiv received')
	    plotSpinner(0);
	    $('#lastTrialPlotID').html(msg.plotDiv);				
    });
    socket.on('refreshvideostream', function(msg) {
	    console.log('refreshvideostream received')
	    setStatus(msg);				
	    window.location.reload()
    });*/
	});
	
	function addNewhostinfoTab()
	{
		$.addDynaTab({
			tabID : 'hostinfotab',
			type : 'ajax',
			url : 'ajaxcontent.html',
			method : 'get',
			dtype : 'html',
			params : {},
			tabTitle : 'New Ajax Tab'
		});
	}

  // convenience method to stringify a JSON object
  function toJSON(obj) {
      return JSON.stringify(obj, null, 4);
  }

  function addNode() {
      try {
          nodes.add({
              id: '4',
              label: 'PC4',
              image: 'Hardware-My-Computer-3-icon.png', shape: 'image'
          });
      }
      catch (err) {
          alert(err);
      }
  }

  function addEdge() {
      try {
          edges.add({
              id: '3',
              from: '2',
              to: '4'
          });
      }
      catch (err) {
          alert(err);
      }
  }

  function draw() {
      // create an array with nodes
      nodes = new vis.DataSet();
      nodes.add([
          {id: '1', label: 'Node 1', image: 'pc.png', shape: 'image', font: '12px Arial white'},
          {id: '2', label: 'Node 2', image: 'pc.png', shape: 'image', font: '12px Arial white'},
          {id: '3', label: 'Node 3', image: 'pc.png', shape: 'image', font: '12px Arial white'},
      ]);

      // create an array with edges
      edges = new vis.DataSet();
      edges.add([
          {id: '1', from: '1', to: '2'},
          {id: '2', from: '1', to: '3'},
      ]);

      // create a network
      var container = document.getElementById('network');
      var data = {
          nodes: nodes,
          edges: edges
      };
      var options = {};
      network = new vis.Network(container, data, options);

      network.on("click", function (params) {
          params.event = "[original event]";
          alert('Click event:' + JSON.stringify(params, null, 4));
          console.log('click event, getNodeAt returns: ' + this.getNodeAt(params.pointer.DOM));
      });
  }

	</script>


</head>
<body onload="draw()">

<main id='main_content'>
<div class='wrap'>
  <div class="column leftside">
    <h2>Controller</h2>
      <button class='control' onclick="myFunction()">upload script to target</button> 
      <button class='control' onclick="myFunction()">pause/run execution</button> 
      <button class='control' onclick="myFunction()">abort</button> 
      <button class='control' onclick="myFunction()">quit</button> 
  </div>

  <div class="column middle">
    <h2>Network overview</h2>	
    <div id="network" class="network"></div>	
  </div>

  
  <div class="column rightside" id="hostinfo">
    <h2>Hostinfo</h2>		
		<h3>ps</h3>
<pre>UID        PID  PPID  C STIME TTY          TIME CMD
root         1     0  0 20:03 ?        00:00:03 /sbin/init
root         2     0  0 20:03 ?        00:00:00 [kthreadd]
root         4     2  0 20:03 ?        00:00:00 [kworker/0:0H]
root         6     2  0 20:03 ?        00:00:00 [mm_percpu_wq]
root         7     2  0 20:03 ?        00:00:00 [ksoftirqd/0]
root         8     2  0 20:03 ?        00:00:02 [rcu_sched]
root         9     2  0 20:03 ?        00:00:00 [rcu_bh]
root        10     2  0 20:03 ?        00:00:00 [migration/0]
root        11     2  0 20:03 ?        00:00:00 [watchdog/0]
root        12     2  0 20:03 ?        00:00:00 [cpuhp/0]
root        13     2  0 20:03 ?        00:00:00 [cpuhp/1]
root        14     2  0 20:03 ?        00:00:00 [watchdog/1]
root        15     2  0 20:03 ?        00:00:00 [migration/1]
root        16     2  0 20:03 ?        00:00:00 [ksoftirqd/1]
root        18     2  0 20:03 ?        00:00:00 [kworker/1:0H]
root        19     2  0 20:03 ?        00:00:00 [cpuhp/2]
root        20     2  0 20:03 ?        00:00:00 [watchdog/2]
</pre>
		<h3>syslog</h3>
<pre>Jun 20 22:18:44 WOPR-PC org.freedesktop.thumbnails.Thumbnailer1[2050]: Registered thumbailer gnome-thumbnail-font --size %s %u %o
Jun 20 22:18:44 WOPR-PC org.freedesktop.thumbnails.Thumbnailer1[2050]: Registered thumbailer /usr/bin/gdk-pixbuf-thumbnailer -s %s %u %o
Jun 20 22:18:44 WOPR-PC org.freedesktop.thumbnails.Thumbnailer1[2050]: Registered thumbailer atril-thumbnailer -s %s %u %o
Jun 20 22:18:44 WOPR-PC org.freedesktop.thumbnails.Thumbnailer1[2050]: Registered thumbailer /usr/bin/gdk-pixbuf-thumbnailer -s %s %u %o
Jun 20 22:18:44 WOPR-PC org.freedesktop.thumbnails.Thumbnailer1[2050]: Registered thumbailer gnome-raw-thumbnailer -s %s %u %o
Jun 20 22:18:44 WOPR-PC dbus-daemon[2050]: [session uid=1000 pid=2050] Successfully activated service &apos;org.freedesktop.thumbnails.Thumbnailer1&apos;
Jun 20 22:22:49 WOPR-PC dbus-daemon[2050]: [session uid=1000 pid=2050] Activating via systemd: service name=&apos;org.gnome.Terminal&apos; unit=&apos;gnome-terminal-server.service&apos; requested by &apos;:1.100&apos; (uid=1000 pid=5485 comm=&quot;/usr/bin/gnome-terminal.real &quot; label=&quot;unconfined&quot;)
Jun 20 22:22:49 WOPR-PC systemd[1999]: Starting GNOME Terminal Server...
Jun 20 22:22:49 WOPR-PC dbus-daemon[2050]: [session uid=1000 pid=2050] Successfully activated service &apos;org.gnome.Terminal&apos;
Jun 20 22:22:49 WOPR-PC systemd[1999]: Started GNOME Terminal Server.
</pre>
		<h3>netstat</h3>
<pre>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      -                   
tcp        0      0 192.168.192.21:48978    50.112.34.20:443        ESTABLISHED 3508/firefox        
tcp        0      0 192.168.192.21:43818    216.58.208.106:80       TIME_WAIT   -                   
tcp        0      0 192.168.192.21:43820    216.58.208.106:80       ESTABLISHED 3508/firefox        
tcp6       0      0 ::1:631                 :::*                    LISTEN      -   </pre>
  </div>

	<div class="footer" id="hostlog">
		<!-- Tab Body Start -->
		<div class="tabcontents" id="hostlogbody">
			<div id="logtab1"> <pre><font color="#00FF00"><b>Host1</b></font>:<font color="#5C5CFF"><b>~</b></font>$ tail /var/log/syslog
Jun 20 22:18:44 WOPR-PC dbus-daemon[2050]: [session uid=1000 pid=2050] Successfully activated service &apos;org.freedesktop.thumbnails.Thumbnailer1&apos;
Jun 20 22:22:49 WOPR-PC dbus-daemon[2050]: [session uid=1000 pid=2050] Activating via systemd: service name=&apos;org.gnome.Terminal&apos; unit=&apos;gnome-terminal-server.service&apos; requested by &apos;:1.100&apos; (uid=1000 pid=5485 comm=&quot;/usr/bin/gnome-terminal.real &quot; label=&quot;unconfined&quot;)
Jun 20 22:22:49 WOPR-PC systemd[1999]: Starting GNOME Terminal Server...
Jun 20 22:22:49 WOPR-PC dbus-daemon[2050]: [session uid=1000 pid=2050] Successfully activated service &apos;org.gnome.Terminal&apos;
Jun 20 22:22:49 WOPR-PC systemd[1999]: Started GNOME Terminal Server.
</pre> </div>
			<div id="logtab2"> <pre><font color="#00FF00"><b>192.168.1.10</b></font>:<font color="#5C5CFF"><b>~</b></font>$ dmesg | tail
[ 9355.800927] [UFW BLOCK] IN=wlp2s0 OUT= MAC=34:f3:9a:ef:04:52:54:fa:3e:b2:d7:62:08:00 SRC=213.254.244.21 DST=192.168.192.21 LEN=40 TOS=0x00 PREC=0x00 TTL=50 ID=5109 DF PROTO=TCP SPT=443 DPT=38668 WINDOW=0 RES=0x00 RST URGP=0 
[ 9355.801312] [UFW BLOCK] IN=wlp2s0 OUT= MAC=34:f3:9a:ef:04:52:54:fa:3e:b2:d7:62:08:00 SRC=213.254.244.21 DST=192.168.192.21 LEN=40 TOS=0x00 PREC=0x00 TTL=50 ID=5110 DF PROTO=TCP SPT=443 DPT=38668 WINDOW=0 RES=0x00 RST URGP=0 
[ 9356.708626] [UFW BLOCK] IN=wlp2s0 OUT= MAC=34:f3:9a:ef:04:52:54:fa:3e:b2:d7:62:08:00 SRC=185.33.223.216 DST=192.168.192.21 LEN=40 TOS=0x08 PREC=0x20 TTL=53 ID=52265 DF PROTO=TCP SPT=443 DPT=35992 WINDOW=0 RES=0x00 RST URGP=0 
[ 9356.709008] [UFW BLOCK] IN=wlp2s0 OUT= MAC=34:f3:9a:ef:04:52:54:fa:3e:b2:d7:62:08:00 SRC=185.33.223.216 DST=192.168.192.21 LEN=40 TOS=0x08 PREC=0x20 TTL=53 ID=52266 DF PROTO=TCP SPT=443 DPT=35992 WINDOW=0 RES=0x00 RST URGP=0 
[ 9356.852962] [UFW BLOCK] IN=wlp2s0 OUT= MAC=34:f3:9a:ef:04:52:54:fa:3e:b2:d7:62:08:00 SRC=185.33.223.216 DST=192.168.192.21 LEN=40 TOS=0x08 PREC=0x20 TTL=53 ID=52289 DF PROTO=TCP SPT=443 DPT=36070 WINDOW=0 RES=0x00 RST URGP=0 
[ 9356.854299] [UFW BLOCK] IN=wlp2s0 OUT= MAC=34:f3:9a:ef:04:52:54:fa:3e:b2:d7:62:08:00 SRC=185.33.223.216 DST=192.168.192.21 LEN=40 TOS=0x08 PREC=0x20 TTL=53 ID=52290 DF PROTO=TCP SPT=443 DPT=36070 WINDOW=0 RES=0x00 RST URGP=0 
[ 9375.695245] [UFW BLOCK] IN=wlp2s0 OUT= MAC=34:f3:9a:ef:04:52:54:fa:3e:b2:d7:62:08:00 SRC=72.251.245.181 DST=192.168.192.21 LEN=40 TOS=0x00 PREC=0x00 TTL=54 ID=18635 DF PROTO=TCP SPT=443 DPT=46838 WINDOW=0 RES=0x00 RST URGP=0 
[ 9394.486274] [UFW BLOCK] IN=wlp2s0 OUT= MAC=34:f3:9a:ef:04:52:54:fa:3e:b2:d7:62:08:00 SRC=185.33.223.216 DST=192.168.192.21 LEN=40 TOS=0x08 PREC=0x20 TTL=53 ID=56790 DF PROTO=TCP SPT=443 DPT=36346 WINDOW=0 RES=0x00 RST URGP=0 
[ 9440.567993] [UFW BLOCK] IN=wlp2s0 OUT= MAC=34:f3:9a:ef:04:52:54:fa:3e:b2:d7:62:08:00 SRC=37.252.161.184 DST=192.168.192.21 LEN=40 TOS=0x08 PREC=0x20 TTL=53 ID=582 DF PROTO=TCP SPT=443 DPT=41938 WINDOW=0 RES=0x00 RST URGP=0 
[ 9444.206527] [UFW BLOCK] IN=wlp2s0 OUT= MAC=34:f3:9a:ef:04:52:54:fa:3e:b2:d7:62:08:00 SRC=52.17.116.123 DST=192.168.192.21 LEN=40 TOS=0x00 PREC=0x00 TTL=237 ID=11084 DF PROTO=TCP SPT=443 DPT=52198 WINDOW=0 RES=0x00 RST URGP=0 
</pre> </div>
			<div id="logtab3"> <pre><font color="#00FF00"><b>hacker.com</b></font>:<font color="#5C5CFF"><b>/</b></font>$ ls
<font color="#5C5CFF"><b>bin</b></font>   <font color="#5C5CFF"><b>cdrom</b></font>  <font color="#5C5CFF"><b>dev</b></font>  <font color="#5C5CFF"><b>home</b></font>        <font color="#00FFFF"><b>initrd.img.old</b></font>  <font color="#5C5CFF"><b>lib32</b></font>  <font color="#5C5CFF"><b>lost+found</b></font>  <font color="#5C5CFF"><b>mnt</b></font>  <font color="#5C5CFF"><b>proc</b></font>  <font color="#5C5CFF"><b>run</b></font>   <font color="#5C5CFF"><b>srv</b></font>       <font color="#5C5CFF"><b>sys</b></font>  <font color="#5C5CFF"><b>usr</b></font>  <font color="#00FFFF"><b>vmlinuz</b></font>
<font color="#5C5CFF"><b>boot</b></font>  core   <font color="#5C5CFF"><b>etc</b></font>  <font color="#00FFFF"><b>initrd.img</b></font>  <font color="#5C5CFF"><b>lib</b></font>             <font color="#5C5CFF"><b>lib64</b></font>  <font color="#5C5CFF"><b>media</b></font>       <font color="#5C5CFF"><b>opt</b></font>  <font color="#5C5CFF"><b>root</b></font>  <font color="#5C5CFF"><b>sbin</b></font>  swapfile  <span style="background-color:#00CD00"><font color="#000000">tmp</font></span>  <font color="#5C5CFF"><b>var</b></font>  <font color="#00FFFF"><b>vmlinuz.old</b></font>
</pre>
 </div>
		</div>
		<!-- Tab Body End --> 
		<!-- Tab Headers Start -->
		<ul class="tabs" id="hostlogtab">
			<li><a data-toggle="tab" href="#logtab1">Host1</a></li>
			<li><a data-toggle="tab" href="#logtab2">192.168.1.10</a></li>
			<li><a data-toggle="tab" href="#logtab3">hacker.com</a></li>
			<!--<li><a data-toggle="tab" href="#logtab1">Host1</a></li>
			<li><a data-toggle="tab" href="#logtab2">192.168.1.10</a></li>
			<li><a data-toggle="tab" href="#logtab3">hacker.com</a></li>
			<li><a data-toggle="tab" href="#logtab1">Host1</a></li>
			<li><a data-toggle="tab" href="#logtab2">192.168.1.10</a></li>
			<li><a data-toggle="tab" href="#logtab3">hacker.com</a></li>
			<li><a data-toggle="tab" href="#logtab1">Host1</a></li>
			<li><a data-toggle="tab" href="#logtab2">192.168.1.10</a></li>
			<li><a data-toggle="tab" href="#logtab3">hacker.com</a></li> -->
		</ul>
		<!-- Tab Headers End --> 
	</div>
</div>
</main>
</body>
</html>

